<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>事業者未納一覧</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <h1>事業者未納一覧</h1>
  <form id="searchForm">
    <input name="name" placeholder="事業者名" required>
    <button type="submit">検索</button>
  </form>
  <table id="unpaid">
    <thead><tr><th>期別</th><th>金額</th></tr></thead>
    <tbody></tbody>
  </table>
  <script>
    document.getElementById('searchForm').addEventListener('submit', async e => {
      e.preventDefault();
      const name = e.target.name.value;
      const res = await fetch(`/api/business/${encodeURIComponent(name)}/unpaid`);
      const data = await res.json();
      const tbody = document.querySelector('#unpaid tbody');
      tbody.innerHTML = '';
      data.forEach(p => {
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${p.period}</td><td>${p.amount}</td>`;
        tbody.appendChild(tr);
      });
    });
  </script>
</body>
</html>
